---
title: "Numpy基础"
date: 2021-06-20T12:25:11+08:00
draft: true
tags: [python, 数据分析]
---

Numpy 是 Python 的一个**高性能**科学计算和数据分析的基础包，它为更高效地使用其他工具提供基础。

它高效在它的数据结构——Numpy数组，是一种N维数组对象(ndarray)，**它的元素必须是相同数据类型**，可以进行快速的矢量数组运算。而且Numpy数组的矢量运算与普通标量运算的语法几乎一样，相应知识可以非常自然地迁移过来。

``` python
In [2]: data * 10
Out[2]: 
array([[10, 20, 30],
       [40, 50, 60]])
```

``` python
In [3]: data + data
Out[3]: 
array([[ 2,  4,  6],
       [ 8, 10, 12]])
```

### ndarray的创建

#### 一般创建

``` python
In [1]: import numpy as np
   ...: data = np.array([[1, 2, 3], [4, 5, 6]])
   ...: data
Out[1]: 
array([[1, 2, 3],
       [4, 5, 6]])
```

``` python
In [5]: data.dtype  # 数据类型
Out[5]: dtype('int32')
```

``` python
In [6]: data.ndim  # 数据维度
Out[6]: 2
```

#### 初始化创建

``` python
In [7]: np.zeros(5)
Out[7]: array([0., 0., 0., 0., 0.])
```

``` python
In [8]: np.zeros((3,4))
Out[8]: 
array([[0., 0., 0., 0.],
       [0., 0., 0., 0.],
       [0., 0., 0., 0.]])
```

``` python
In [9]: np.ones(3)
Out[9]: array([1., 1., 1.])
```

``` python
In [11]: np.empty((2,4))  # 返回未初始化的垃圾值
Out[11]: 
array([[6.23042070e-307, 1.89146896e-307, 1.37961302e-306,
        1.05699242e-307],
       [8.01097889e-307, 7.56598449e-307, 1.60220393e-306,
        2.22522596e-306]])
```

``` python
In [14]: np.eye(4)  # 单位矩阵
Out[14]: 
array([[1., 0., 0., 0.],
       [0., 1., 0., 0.],
       [0., 0., 1., 0.],
       [0., 0., 0., 1.]])
```

``` python
In [15]: np.identity(4)  # 单位矩阵
Out[15]: 
array([[1., 0., 0., 0.],
       [0., 1., 0., 0.],
       [0., 0., 1., 0.],
       [0., 0., 0., 1.]])
```

arrange函数是Python内置函数range的数组版：

``` python
In [12]: np.arange(6)
Out[12]: array([0, 1, 2, 3, 4, 5])
```

#### 其他函数

| 数组创建函数                   | 说明                                       |
| ------------------------------ | ------------------------------------------ |
| asarray                        | 将输出转换为ndarray                        |
| ones_like/zero_like/empty_like | 以另一数组为参数，根据其形状创建一个新数组 |

### ndarray的数据类型



### 数组和标量之间的运算

**形状相同的数组**之间的任何算术运算都将应用到元素级。

``` python
In [1]: data
Out[1]: 
array([[1, 2, 3],
       [4, 5, 6]])
In [4]: data.shape
Out[4]: (2, 3)
```

``` python
In [16]: data * data
Out[16]: 
array([[ 1,  4,  9],
       [16, 25, 36]])
```

同样地，数组与标量的算术运算会**广播**到各个元素。（不同大小数组之间的运算叫做广播broadcasting）

``` python
In [17]: data * 2
Out[17]: 
array([[ 2,  4,  6],
       [ 8, 10, 12]])
```

### 基本索引和切片

和Python的列表功能差不多，但当将一个标量赋值给一个切片时，该值会自动广播到整个选取。

``` python
In [43]: arr = np.arange(8)

In [44]: arr[4:6] = 100

In [45]: arr
Out[45]: array([  0,   1,   2,   3, 100, 100,   6,   7])
```



跟列表最重要的区别在于，数组切片是原始数组的视图，原数据不会被复制（为了高性能），**视图上的任何修改都会直接反映到源数组上**。

``` python
In [20]: arr = np.arange(10)

In [21]: arr_slice = arr[5:8]

In [22]: arr_slice[1] = 123

In [23]: arr
Out[23]: array([  0,   1,   2,   3,   4,   5, 123,   7,   8,   9])
```

如果想得到arr切片的副本而非视图，需要用`arr[5:8].copy()`。

### 布尔型索引

``` python
In [26]: arr
Out[26]: array([  0,   1,   2,   3,   4,   5, 123,   7,   8,   9])

In [27]: arr == 4
Out[27]: 
array([False, False, False, False,  True, False, False, False, False,
       False])
```

注意，Python关键字and和or在布尔型数组中无效，要用 & 和 | 。

### 花式索引

利用整数数组进行索引。

``` python
In [30]: arr = np.empty((8,4))

In [31]: for i in range(8):
    ...:     arr[i] = i
    ...:     

In [32]: arr
Out[32]: 
array([[0., 0., 0., 0.],
       [1., 1., 1., 1.],
       [2., 2., 2., 2.],
       [3., 3., 3., 3.],
       [4., 4., 4., 4.],
       [5., 5., 5., 5.],
       [6., 6., 6., 6.],
       [7., 7., 7., 7.]])

In [33]: arr[[4, 3, 0, 6]]
Out[33]: 
array([[4., 4., 4., 4.],
       [3., 3., 3., 3.],
       [0., 0., 0., 0.],
       [6., 6., 6., 6.]])
```

但两组整数返回的是对应位置的值即 (1,0) (5,3) (7,1) (1,2)。

``` python
In [34]: arr[[1, 5, 7, 1], [0, 3, 1, 2]]
Out[34]: array([1., 5., 7., 1.])
```

### 数组转置和轴对换

转置：

``` python
In [35]: arr = np.arange(15).reshape(3,5)

In [36]: arr
Out[36]: 
array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14]])

In [37]: arr.T
Out[37]: 
array([[ 0,  5, 10],
       [ 1,  6, 11],
       [ 2,  7, 12],
       [ 3,  8, 13],
       [ 4,  9, 14]])
```

内积：

``` python
In [39]: np.dot(arr.T, arr)
Out[39]: 
array([[125, 140, 155, 170, 185],
       [140, 158, 176, 194, 212],
       [155, 176, 197, 218, 239],
       [170, 194, 218, 242, 266],
       [185, 212, 239, 266, 293]])
```

